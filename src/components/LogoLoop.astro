---
import type { SvgComponent } from "astro/types";

export interface Logo {
  Svg: SvgComponent;
  alt: string;
  label?: string;
  href?: string;
}

interface Props {
  logos: Logo[];
  speed?: number;
  logoHeight?: number;
  gap?: number;
  class?: string;
}

const {
  logos,
  speed = 25,
  logoHeight = 32,
  gap = 48,
  class: className,
} = Astro.props;
---

<div class:list={["logo-slider", className]} data-speed={speed} data-gap={gap}>
  <div class="logo-track">
    {/* Original logos */}
    {logos.map((logo) => {
      const Svg = logo.Svg;
      return (
        <div class="logo-item">
          {logo.href ? (
            <a href={logo.href} target="_blank" rel="noopener noreferrer">
              <Svg width={logoHeight} height={logoHeight} aria-label={logo.alt} />
              {logo.label && <span class="logo-label">{logo.label}</span>}
            </a>
          ) : (
            <>
              <Svg width={logoHeight} height={logoHeight} aria-label={logo.alt} />
              {logo.label && <span class="logo-label">{logo.label}</span>}
            </>
          )}
        </div>
      );
    })}
    {/* Cloned logos for infinite loop */}
    {logos.map((logo) => {
      const Svg = logo.Svg;
      return (
        <div class="logo-item" aria-hidden="true">
          {logo.href ? (
            <a href={logo.href} target="_blank" rel="noopener noreferrer" tabindex="-1">
              <Svg width={logoHeight} height={logoHeight} aria-label={logo.alt} />
              {logo.label && <span class="logo-label">{logo.label}</span>}
            </a>
          ) : (
            <>
              <Svg width={logoHeight} height={logoHeight} aria-label={logo.alt} />
              {logo.label && <span class="logo-label">{logo.label}</span>}
            </>
          )}
        </div>
      );
    })}
  </div>
</div>

<style>
  .logo-slider {
    overflow: hidden;
    white-space: nowrap;
    width: 100%;
  }
  
  .logo-track {
    display: inline-flex;
    white-space: nowrap;
    animation: scroll 60s linear infinite;
  }
  
  .logo-item {
    height: 32px;
    margin: 0 24px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    opacity: 0.5;
    transition: opacity 0.3s ease;
    vertical-align: middle;
  }
  
  .logo-item:hover {
    opacity: 1;
  }
  
  .logo-label {
    font-size: 18px;
    font-family: var(--font-mono);
    color: var(--muted-foreground);
  }
  
  @keyframes scroll {
    0% {
      transform: translateX(-50%);
    }
    100% {
      transform: translateX(0);
    }
  }
</style>

<script>
  // Clone logos for infinite scroll
  document.querySelectorAll('.logo-slider').forEach((slider) => {
    const track = slider.querySelector('.logo-track');
    if (!track) return;
    
    const logos = Array.from(track.children);
    logos.forEach((logo) => {
      const clone = logo.cloneNode(true);
      track.appendChild(clone);
    });
    
    // Pause on hover
    slider.addEventListener('mouseenter', () => {
      (track as HTMLElement).style.animationPlayState = 'paused';
    });
    
    slider.addEventListener('mouseleave', () => {
      (track as HTMLElement).style.animationPlayState = 'running';
    });
  });
</script>
