<div
  id="status-bar"
  class="flex shrink-0 items-center justify-between border-t border-border bg-[var(--surface)] px-2 pb-[env(safe-area-inset-bottom,0px)] h-[calc(32px+env(safe-area-inset-bottom,0px))] sm:px-4"
>
  <div class="flex items-center gap-2 sm:gap-4">
    <button
      class="inline-flex items-center gap-1 rounded px-2 py-0.5 font-mono text-[12px] text-muted-foreground opacity-70 transition-[color,background,opacity] duration-200 hover:bg-primary/10 hover:text-primary hover:opacity-100 active:bg-primary/20"
      id="info-btn"
      title="Document info"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
      <span>Info</span>
    </button>
  </div>

  <div class="flex items-center gap-3">
    <button
      class="inline-flex items-center gap-1 rounded px-2 py-0.5 font-mono text-[12px] text-muted-foreground opacity-70 transition-[color,background,opacity] duration-200 hover:bg-primary/10 hover:text-primary hover:opacity-100 active:bg-primary/20"
      id="lint-fix"
      title="Fix lint issues"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/><path d="m15 5 4 4"/></svg>
      Fix
    </button>
    <span
      class="inline-flex items-center gap-[5px] font-mono text-[12px] text-muted-foreground opacity-70 transition-colors duration-300 [&.has-issues]:text-[var(--warning)] [&.has-issues]:opacity-100 [&.no-issues]:text-[var(--success)] [&.no-issues]:opacity-70"
      id="status-lint"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
      <span class="lint-count">0 issues</span>
    </span>
    <span
      class="inline-flex items-center gap-[5px] font-mono text-[12px] text-muted-foreground opacity-70 transition-[color,opacity] duration-300 [&_.save-icon--saving]:hidden [&_.save-icon--check]:inline-block [&.saving]:text-primary [&.saving]:opacity-100 [&.saving_.save-icon--saving]:inline-block [&.saving_.save-icon--saving]:animate-spin [&.saving_.save-icon--check]:hidden [&.saved]:text-[var(--success)] [&.saved]:opacity-100"
      id="status-save"
    >
      <svg class="save-icon save-icon--check" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
      <svg class="save-icon save-icon--saving" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
      <span class="save-label">Saved locally</span>
    </span>
  </div>
</div>

<div
  id="info-popup"
  class="fixed bottom-10 left-2 z-[1000] hidden"
  role="dialog"
  aria-label="Document information"
>
  <div class="min-w-[180px] overflow-hidden rounded-lg border border-border bg-[var(--surface)] shadow-[0_4px_16px_rgba(0,0,0,0.3)]">
    <div class="flex items-center justify-between border-b border-border px-3 py-2">
      <span class="text-[12px] font-semibold text-foreground">Document Info</span>
      <button
        class="flex items-center justify-center rounded p-0.5 text-muted-foreground transition-colors hover:bg-primary/10 hover:text-foreground"
        id="info-popup-close"
        aria-label="Close"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
      </button>
    </div>
    <div class="grid grid-cols-2 gap-x-4 gap-y-2 px-3 py-2">
      <div class="flex items-center justify-between" id="info-lines">
        <span class="text-[11px] text-muted-foreground opacity-70">Lines</span>
        <span class="font-mono text-[12px] font-medium text-foreground info-stat-value">0</span>
      </div>
      <div class="flex items-center justify-between" id="info-words">
        <span class="text-[11px] text-muted-foreground opacity-70">Words</span>
        <span class="font-mono text-[12px] font-medium text-foreground info-stat-value">0</span>
      </div>
      <div class="flex items-center justify-between" id="info-chars">
        <span class="text-[11px] text-muted-foreground opacity-70">Chars</span>
        <span class="font-mono text-[12px] font-medium text-foreground info-stat-value">0</span>
      </div>
      <div class="flex items-center justify-between" id="info-tokens">
        <span class="text-[11px] text-muted-foreground opacity-70">Tokens</span>
        <span class="font-mono text-[12px] font-medium text-foreground info-stat-value">0</span>
      </div>
    </div>
  </div>
</div>

<script>
  const infoBtn = document.getElementById("info-btn")
  const infoPopup = document.getElementById("info-popup")
  const infoPopupClose = document.getElementById("info-popup-close")

  function togglePopup() {
    if (!infoPopup) return
    const isHidden = infoPopup.classList.contains("hidden")
    if (isHidden) {
      infoPopup.classList.remove("hidden")
    } else {
      infoPopup.classList.add("hidden")
    }
  }

  function closePopup() {
    infoPopup?.classList.add("hidden")
  }

  infoBtn?.addEventListener("click", togglePopup)
  infoPopupClose?.addEventListener("click", closePopup)

  document.addEventListener("click", (e) => {
    if (!infoPopup || !infoBtn) return
    if (!infoPopup.contains(e.target as Node) && !infoBtn.contains(e.target as Node)) {
      closePopup()
    }
  })

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closePopup()
  })
</script>
